---
title: "[BOJ 1605] ë°˜ë³µ ë¶€ë¶„ë¬¸ìì—´"
date: 2025-03-09
categories: [ì•Œê³ ë¦¬ì¦˜, ë°±ì¤€]
tags: [ë°±ì¤€, C++, ì ‘ë¯¸ì‚¬ ë°°ì—´, LCP, Platinum]
---

[![ë°±ì¤€ ë¡œê³ ](assets/img/posts/BOJ/boj-og.png)](https://www.acmicpc.net/problem/1605)

[ë°±ì¤€ ë¬¸ì œ ë§í¬](https://www.acmicpc.net/problem/1605)

## ğŸ” ë¬¸ì œ ë¶„ì„
> ìì„¸í•œ ë‚´ìš©ì€ [ì ‘ë¯¸ì‚¬ ë°°ì—´(Suffix Array) ë° LCP(Longest Common Prefix)ì ‘ë¯¸ì‚¬ ë°°ì—´](../Suffix_Array) í˜ì´ì§€ë¥¼ ì°¸ê³ í•œë‹¤.
{: .prompt-tip }

- ë°˜ë³µë˜ëŠ” ë¶€ë¶„ ë¬¸ìì—´ì€ ì ‘ë¯¸ì‚¬ë“¤ì˜ ê³µí†µ ì ‘ë‘ì‚¬ë¡œ ì´í•´í•  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ, **LCP ë°°ì—´**ì„ ê³„ì‚°í•œ ë’¤ ë°°ì—´ì˜ ìµœëŒ“ê°’ì„ í†µí•´ì„œ ë°˜ë³µë˜ëŠ” ë¶€ë¶„ ë¬¸ìì—´ì˜ ìµœëŒ“ê°’ì„ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤.

## ğŸ’» ì½”ë“œ êµ¬í˜„

```c++
#include <bits/stdc++.h>
#define fastio cin.tie(0)->ios::sync_with_stdio(0)

using namespace std;
using ll = long long;
using pi = pair<int, int>;
using pll = pair<ll, ll>;
using vi = vector<int>;
using vvi = vector<vector<int>>;
using vvll = vector<vector<ll>>;
using vll = vector<ll>;
using vpi = vector<pi>;

constexpr int MAX = 200'000;

int n, sa[MAX], g[MAX], lcp[MAX];
string s;

int main() {
    fastio;

    cin >> n >> s;

    for (int i = 0; i < s.size(); ++i) {
        sa[i] = i;
        g[i] = s[i];
    }

    for (int i = 0; (1 << i) < s.size(); i++) {
        auto cmp = [&] (int lhs, int rhs) {
            if (g[lhs] == g[rhs]) {
                lhs += 1 << i;
                rhs += 1 << i;
                if (lhs < s.size() && rhs < s.size()) {
                    return g[lhs] < g[rhs];
                } 
                return lhs > rhs;
            }
            return g[lhs] < g[rhs];
        };

        sort(begin(sa), begin(sa) + s.size(), cmp);

        int tmp[MAX] = { 0 };
        for (int j = 0; j < s.size() - 1; ++j) {
            tmp[j + 1] = tmp[j] + cmp(sa[j], sa[j + 1]);
        }

        for (int j = 0; j < s.size(); ++j) {
            g[sa[j]] = tmp[j];
        }

        if (g[s.size() - 1] == s.size() - 1) break;
    }

    int k = 0;
    for (int i = 0; i < s.size(); ++i) {
        if (g[i] == 0) continue;
        while (
            (i + k < s.size() && sa[g[i] - 1 < s.size()]) &&
            s[i + k] == s[sa[g[i] - 1] + k]
        ) ++k;
        lcp[g[i]] = k--;
        k = max(k, 0);
    }

    cout << *max_element(begin(lcp), begin(lcp) + s.size());
}
```

## ğŸ“ ì½”ë“œ ì„¤ëª…

## ğŸ”§ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…

## ğŸ“š ì°¸ê³ ìë£Œ
- [ì ‘ë¯¸ì‚¬ ë°°ì—´(Suffix Array) ë° LCP(Longest Common Prefix)ì ‘ë¯¸ì‚¬ ë°°ì—´](../Suffix_Array)